<?xml version="1.0" encoding="utf-8"?>
<Exports xmlns="http://schemas.itin.com/export/engine/2014/configuration/v1.0">

  <References>
    <Reference Path="~\Resources\Functions\" Assembly="iTinExportEngineFunctions"/>
  </References>

  <Global.Resources>
    <Hosts>
      <Host Key="xlsx">
        <Document Orientation="Landscape" Size="A3">
          <Metadata>
            <Author>Your Name</Author>
            <Company>Your Company</Company>
            <Comments>How to use binded functions</Comments>
            <Title>Sample10</Title>
          </Metadata>
          <Margins Bottom="10" Top="10" Right="10" Left="10" Units="Millimeters"/>
        </Document>
      </Host>
    </Hosts>
    <Conditions>
      <MinimumCondition Key="MinimumTotalCondition" Field="TOTAL" Style="MinimumTotalConditionStyle"/>
    </Conditions>
    <Groups>
      <Group Name="CustomerName">
        <Field Name="CUSTOMERFIRSTNAME" Separator=", "/>
        <Field Name="CUSTOMERLASTNAME"/>
      </Group>
    </Groups>
    <Images>
      <Image Key="banner">
        <Effects>
          <GrayScale/>
          <Opacity percent="90"/>
        </Effects>
        <Path>~\resources\images\banner-careers.png</Path>
      </Image>
    </Images>
    <Lines>
      <TextLine Key="ReportTitleLine" Style="ReportTitleStyle">
        <Text Merge="11">Invoice report from configuration file</Text>
      </TextLine>
      <TextLine Key="ReportInformationLine01" Style="ReportInformationLineStyle">
        <Text>From:</Text>
        <Text Merge="2" Style="ReportInformationLine01Style">{StaticBinding:Common.GetCurrentDatetime}</Text>
        <Text Style="ReportInformationLine01Style">{StaticBinding:Common.GetCurrentTimeSpan}</Text>
      </TextLine>
      <TextLine Key="ReportInformationLine02" Style="ReportInformationLineStyle">
        <Text>To:</Text>
        <Text Merge="2" Style="ReportInformationLine02Style">{StaticBinding:Common.GetCurrentDatetime}</Text>
        <Text Style="ReportInformationLine02Style">{StaticBinding:Common.GetCurrentTimeSpan}</Text>
      </TextLine>
    </Lines>
    <Styles>
      <Style Name="ReportTitleStyle">
        <Content>
          <Alignment Horizontal="Center"/>
          <Text/>
        </Content>
        <Font Name="Calibri" Size="18" Bold="Yes"/>
      </Style>
      <Style Name="ReportInformationLineStyle">
        <Content>
          <Alignment/>
          <Text/>
        </Content>
        <Font Name="Calibri" Bold="Yes"/>
      </Style>
      <Style Name="ReportInformationLine01Style">
        <Content>
          <Alignment/>
          <DateTime Format="Long Date" Locale ="en-US"/>
        </Content>
        <Font Name="Calibri"/>
      </Style>
      <Style Name="ReportInformationLine02Style">
        <Content>
          <Alignment/>
          <DateTime Format="Long Date" Locale ="en-US"/>
        </Content>
        <Font Name="Calibri"/>
      </Style>
      <Style Name="HeaderDecimalStyle">
        <Content Color="#ED7D31">
          <Alignment Horizontal="Right"/>
          <Number Separator="Yes"/>
        </Content>
        <Font Name="Calibri" Color="White" Size="12" Bold="Yes"/>
      </Style>
      <Style Name="HeaderStringStyle">
        <Borders>
          <Border Position="Bottom" Color="Black" LineStyle="Continuous" Weight="Medium"/>
        </Borders>
        <Content Color="#ED7D31">
          <Alignment/>
          <Text/>
        </Content>
        <Font Name="Calibri" Color="White" Size="11" Bold="Yes"/>
      </Style>
      <Style Name="HeaderStringNoBorderStyle">
        <Content Color="#ED7D31">
          <Alignment/>
          <Text/>
        </Content>
        <Font Name="Calibri" Color="White" Size="12" Bold="Yes"/>
      </Style>
      <Style Name="HeaderNumericStyle">
        <Content Color="#ED7D31">
          <Alignment Horizontal ="Right"/>
          <Number Decimals="0"/>
        </Content>
        <Font Name="Calibri" Color="White" Size="12" Bold="Yes"/>
      </Style>
      <Style Name="ValueDatetimeStyle">
        <Content Color="#FCE4D6">
          <Alignment/>
          <DateTime Format="Short Date"/>
        </Content>
        <Font Name="Calibri"/>
      </Style>
      <Style Name="ValueDecimalStyle">
        <Content Color="#FCE4D6">
          <Alignment Horizontal="Right"/>
          <Number Separator="Yes"/>
        </Content>
        <Font Name="Calibri"/>
      </Style>
      <Style Name="ValueNumericStyle">
        <Content Color="#ED7D31">
          <Alignment Horizontal="Right"/>
          <Number Decimals="0"/>
        </Content>
        <Font Name="Calibri" Color="White"/>
      </Style>
      <Style Name="ValueStringStyle">
        <Content Color="#FCE4D6">
          <Alignment/>
          <Text/>
        </Content>
        <Font Name="Calibri"/>
      </Style>
      <Style Name="MinimumTotalConditionStyle">
        <Borders>
          <Border Position="Bottom" Color="#ED7D31" LineStyle="Continuous" Weight="Thick" />
        </Borders>
        <Content Color="LightGreen">
          <Alignment Horizontal="Right"/>
          <Number Separator="Yes"/>
        </Content>
        <Font Name="Calibri" Color="White" Size="11" Bold="Yes"/>
      </Style>
    </Styles>
  </Global.Resources>

  <Export Name="Sample10" Current="Yes">
    <Description>How to use binded functions</Description>
    <BlockLines>
      <Block Key="Block01">
        <Location>
          <ByCoordenates Coordenates="1 3"/>
        </Location>
        <Items Keys="ReportTitleLine ReportInformationLine01 ReportInformationLine02"/>
      </Block>
    </BlockLines>
    <Table Host="xlsx"
           Name="Invoice"
           AutoFilter="Yes"
           AutoFitColumns="Yes"
           FreezePanes="2 9"
           ShowGridLines="No"
           Alias="Invoice">
      <Conditions Keys="MinimumTotalCondition"/>       
      <Location>
        <ByCoordenates Coordenates="1 6"/>
      </Location>
      <Logo>
        <Image Key="banner"/>
        <Location>
          <ByCoordenates Coordenates="4 1"/>
        </Location>
      </Logo>
      <Exporter>
        <Writer Name="XlsxTabularWriter"/>
      </Exporter>
      <Headers>
        <Header From="ID" To="DATE" Style="HeaderStringNoBorderStyle" Text="Invoice"/>
        <Header From="CustomerName" To="CUSTOMEREMAIL" Style="HeaderStringNoBorderStyle" Text="Customer information"/>
        <Header From="BILLINGADDRESS" To="TOTAL" Style="HeaderStringNoBorderStyle" Text="Billing information"/>
      </Headers>
      <Fields>
        <Field Name="ID" Alias="Id">
          <Header Style="HeaderStringStyle"/>
          <Value Style="ValueNumericStyle"/>
          <Aggregate Location="Top" Type="Count" Style="HeaderNumericStyle" Show="Yes"/>
        </Field>
        <Field Name="DATE" Alias="Date">
          <Header Style="HeaderStringStyle"/>
          <Value Style="ValueDatetimeStyle"/>
          <Aggregate Location="Top" Type="Text" Style="HeaderStringNoBorderStyle" Text="" Show="Yes"/>
        </Field>
        <Group Name="CustomerName" Alias="Customer">
          <Header Style="HeaderStringStyle"/>
          <Value Style="ValueStringStyle"/>
          <Aggregate Location="Top" Type="Text" Style="HeaderStringNoBorderStyle" Text="" Show="Yes"/>
        </Group>
        <Field Name="CUSTOMERPHONE" Alias="Phone">
          <Header Style="HeaderStringStyle"/>
          <Value Style="ValueStringStyle"/>
          <Aggregate Location="Top" Type="Text" Style="HeaderStringNoBorderStyle" Text="" Show="Yes"/>
        </Field>
        <Field Name="CUSTOMEREMAIL" Alias="Email">
          <Header Style="HeaderStringStyle"/>
          <Value Style="ValueStringStyle"/>
          <Aggregate Location="Top" Type="Text" Style="HeaderStringNoBorderStyle" Text="" Show="Yes"/>
        </Field>
        <Field Name="BILLINGADDRESS" Alias="Address">
          <Header Style="HeaderStringStyle"/>
          <Value Style="ValueStringStyle"/>
          <Aggregate Location="Top" Type="Text" Style="HeaderStringNoBorderStyle" Text="" Show="Yes"/>
        </Field>
        <Field Name="BILLINGCITY" Alias="City">
          <Header Style="HeaderStringStyle"/>
          <Value Style="ValueStringStyle"/>
          <Aggregate Location="Top" Type="Text" Style="HeaderStringNoBorderStyle" Text="" Show="Yes"/>
        </Field>
        <Field Name="BILLINGSTATE" Alias="State">
          <Header Style="HeaderStringStyle"/>
          <Value Style="ValueStringStyle"/>
          <Aggregate Location="Top" Type="Text" Style="HeaderStringNoBorderStyle" Text="" Show="Yes"/>
        </Field>
        <Field Name="BILLINGCOUNTRY" Alias="Country">
          <Header Style="HeaderStringStyle"/>
          <Value Style="ValueStringStyle"/>
          <Aggregate Location="Top" Type="Text" Style="HeaderStringNoBorderStyle" Text="" Show="Yes"/>
        </Field>
        <Field Name="BILLINGPOSTALCODE" Alias="Postal Code">
          <Header Style="HeaderStringStyle"/>
          <Value Style="ValueStringStyle"/>
          <Aggregate Location="Top" Type="Text" Style="HeaderStringNoBorderStyle" Text="" Show="Yes"/>
        </Field>
        <Field Name="TOTAL" Alias="Total">
          <Header Style="HeaderStringStyle"/>
          <Value Style="ValueDecimalStyle"/>
          <Aggregate Location="Top" Type="Sum" Style="HeaderDecimalStyle" Show="Yes"/>
        </Field>
      </Fields>
      <Output>
        <Path>~\output\xlsx\ExportEngine\</Path>
        <File>sample10-from-config-file</File>
      </Output>
    </Table>
  </Export>

</Exports>
